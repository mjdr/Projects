var mainModule = angular.module("main",['ngRoute']);

mainModule.config(['$routeProvider', '$locationProvider',
	  function($routeProvider, $locationProvider) {
	    $routeProvider
	    .when('/', {
	        templateUrl: 'mainTemplate.html',
	        controller: 'mainController',
	      })
	      .when('/login', {
	        templateUrl: 'loginTemplate.html',
	        controller: 'loginController',
	      })
	      .when('/page_edit/:pageId', {
	        templateUrl: '/pageEditTemplate.html',
	        controller: 'pageEditController',
	      })
	      .when('/profile', {
	        templateUrl: 'profileTemplate.html',
	        controller: 'profileController',
	      })
	      .when('/admin', {
	        templateUrl: 'adminProfileTemplate.html',
	        controller: 'adminController',
	      })
	      .when('/register', {
	        templateUrl: 'registerTemplate.html',
	        controller: 'registerController',
	      });
	    
	    
	    $locationProvider.html5Mode(true);
}]);


function getCurrentUser($http,callback){
	$http.post("/user/data").
		success(function(res){
		
		if(res.status == 'ok')
			callback(res.body);
		else 
			callback(undefined);
		
	}).
	error(function(res){
		callback(undefined);
	});
}
function logout($http,$location){
	$http.post("/user/logout").
		success(function(res){
		
		if(res.status == 'ok')
			$location.path("/login");
		
	}).
	error(function(res){
		alert("Server not respond.");
	});
}









